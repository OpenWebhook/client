import{R as r,H as S,s as T,G as y,c as L,a as I,g as v,A as b,I as A,r as E,B as _,b as R,T as g,d as w,e as U,f as O}from"./vendor.8362b35f.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const a of e.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function s(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?e.credentials="include":t.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function l(t){if(t.ep)return;t.ep=!0;const e=s(t);fetch(t.href,e)}})();const N="modulepreload",C=function(o){return"/client/"+o},k={},f=function(n,s,l){if(!s||s.length===0)return n();const t=document.getElementsByTagName("link");return Promise.all(s.map(e=>{if(e=C(e),e in k)return;k[e]=!0;const a=e.endsWith(".css"),u=a?'[rel="stylesheet"]':"";if(!!l)for(let c=t.length-1;c>=0;c--){const h=t[c];if(h.href===e&&(!a||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${e}"]${u}`))return;const i=document.createElement("link");if(i.rel=a?"stylesheet":N,a||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),a)return new Promise((c,h)=>{i.addEventListener("load",c),i.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${e}`)))})})).then(()=>n())};const P=r.createContext({value:"https://webhook-store.herokuapp.com",setValue:o=>{}}),W="identityToken",p="accessToken",m="environment",B=o=>{const s=`${new URL(o).origin}/graphql`,l=s.replace("http","ws"),t=new S({uri:s}),e=T(async(d,{headers:i})=>{var c=localStorage.getItem(p);if(!c){const h=localStorage.getItem(W);h&&(c=await H(h,o))}return{headers:{...i,authorization:c?`Bearer ${c}`:""}}}),a=new y(L({url:l,connectionParams:()=>({authToken:localStorage.getItem(p)})})),u=I(({query:d})=>{const i=v(d);return i.kind==="OperationDefinition"&&i.operation==="subscription"},a,e.concat(t));return new b({link:u,cache:new A})},H=async(o,n)=>{const s=new URL(n).hostname,t=await(await fetch(`${{}.VITE_AUTH_TENANT_URL}/webhook-store-auth/access-token`,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},method:"POST",body:JSON.stringify({webhookStoreUrl:s})})).json();if(t.statusCode>300)throw console.error("Cannot refresh token",t),new Error(t.message);const e=t.accessToken;return localStorage.setItem(p,e),e},V=(o,n,s)=>{const l=localStorage.getItem(o)||n,[t,e]=E.exports.useState(l);return[t,u=>{s(u)?(localStorage.setItem(o,u),e(u)):console.warn("invalid new value, not stored"),_.capture(`${o} update attempt`,{value:u})}]};function $(o){let n;try{n=new URL(o)}catch{return!1}return n.protocol==="http:"||n.protocol==="https:"}const x=r.lazy(()=>f(()=>import("./index.bc8e2959.js"),["assets/index.bc8e2959.js","assets/index.585bf6b5.js","assets/vendor.8362b35f.js","assets/index.c73b4c6e.css","assets/index.447dfe89.css"])),D=r.lazy(()=>f(()=>import("./TopNav.c3b2fd2d.js"),["assets/TopNav.c3b2fd2d.js","assets/vendor.8362b35f.js","assets/index.45d5ebf7.js","assets/index.585bf6b5.js","assets/index.c73b4c6e.css","assets/index.d0772c44.css","assets/TopNav.d55e0533.css"])),K=r.lazy(()=>f(()=>import("./WebhookList.component.09ecec2c.js"),["assets/WebhookList.component.09ecec2c.js","assets/vendor.8362b35f.js","assets/index.45d5ebf7.js","assets/index.585bf6b5.js","assets/index.c73b4c6e.css","assets/index.d0772c44.css","assets/WebhookList.component.ca4371d1.css"]));function Y(){const o=window.location.hostname==="demo.openwebhook.io"?"https://webhook-store.herokuapp.com":window.location.origin,[n,s]=V("webhookStoreUrl",o,$);return r.createElement(P.Provider,{value:{value:n,setValue:s}},r.createElement(R,{client:B(n)},r.createElement(g,{name:g.names.dark},r.createElement(E.exports.Suspense,{fallback:r.createElement("div",null,"Loading...")},r.createElement(x,{topnav:r.createElement(D,null)},r.createElement(K,null))))))}const q=window.location.hostname==="github.webhook.store";q&&(window.location.href=`${{}.VITE_AUTH_TENANT_URL}/oauth/login`);w.configure({apiKey:{}.VITE_HONEYBADGER_API_KEY,environment:"production"});_.init({}.VITE_POSTHOG_API_KEY,{api_host:"https://app.posthog.com"});const z=()=>{localStorage.getItem(m)||(window.location.origin.startsWith("http://localhost:")?localStorage.setItem(m,"development"):localStorage.setItem(m,"production"))};z();const G=U.createRoot(document.getElementById("root"));G.render(r.createElement(O,{honeybadger:w},r.createElement(r.StrictMode,null,r.createElement(Y,null))));export{p as A,m as E,W as I,P as W,f as _};
//# sourceMappingURL=index.656b730a.js.map
